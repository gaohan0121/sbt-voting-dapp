"use strict";(self["webpackChunkweb3_vote"]=self["webpackChunkweb3_vote"]||[]).push([[198],{6397:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(6835),u=n(8534),a=(n(8309),n(6252)),c=n(3577),o=n(4445),i=n(2262),s=n(8970),l={class:"box3"},p={key:0,style:{"text-align":"center",color:"#999",padding:"20px"}};const v={__name:"BoardView",setup:function(e){var t=(0,o.Z)(),n=(t.web3,t.voteContract),v=t.getAccount,f=(0,i.iH)([]),d=function(){var e=(0,u.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.methods.getBoardInfo().call();case 5:t=e.sent,f.value=t,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.error("获取看板信息失败:",e.t0),(0,s.CF)("获取投票看板失败，请检查合约和网络连接。");case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=(0,u.Z)((0,r.Z)().mark((function e(t){var u,a;return(0,r.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,v();case 4:if(u=e.sent,u){e.next=7;break}return e.abrupt("return",(0,s.CF)("请连接MetaMask！"));case 7:return a=null,e.prev=8,a=(0,s.CF)({type:"loading",message:"正在发送投票交易...",forbidClick:!0,duration:0}),e.next=12,n.methods.vote(t).send({from:u});case 12:return a&&a.close(),(0,s.CF)("投票成功！"),e.next=16,d();case 16:e.next=23;break;case 18:e.prev=18,e.t0=e["catch"](8),console.error("投票失败:",e.t0),a&&a.close(),(0,s.CF)("投票失败，请检查是否有投票权或已投票。");case 23:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}();return(0,a.bv)((function(){d()})),function(e,t){var n=(0,a.up)("van-divider"),r=(0,a.up)("van-button"),u=(0,a.up)("van-cell");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)(n,null,{default:(0,a.w5)((function(){return[(0,a.Uk)("投票看板")]})),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(f.value,(function(e,t){return(0,a.wg)(),(0,a.j4)(u,{title:e.name,icon:"shop-o",key:t},{"right-icon":(0,a.w5)((function(){return[(0,a.Wm)(r,{size:"small",type:"primary",onClick:function(e){return k(t)}},{default:(0,a.w5)((function(){return[(0,a.Uk)(" 投票 ("+(0,c.zw)(e.voteCount)+" 票) ",1)]})),_:2},1032,["onClick"])]})),_:2},1032,["title"])})),128)),0===f.value.length?((0,a.wg)(),(0,a.iD)("div",p," 加载中或没有主题 ")):(0,a.kq)("",!0)])}}},f=v,d=f}}]);
//# sourceMappingURL=board.b43aecb9.js.map