"use strict";(self["webpackChunkweb3_vote"]=self["webpackChunkweb3_vote"]||[]).push([[198],{2530:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var r=n(4250),u=(n(7461),n(9545)),a=(n(2332),n(2691)),c=(n(1209),n(124)),o=n(8534),i=(n(8309),n(3396)),s=n(7139),l=n(4445),f=n(4870),p=n(4816),v={class:"box3"},k={key:0,style:{"text-align":"center",color:"#999",padding:"20px"}};const w={__name:"BoardView",setup:function(e){var t=(0,l.Z)(),n=(t.web3,t.voteContract),w=t.getAccount,d=(0,f.iH)([]),b=function(){var e=(0,o.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.methods.getBoardInfo().call();case 5:t=e.sent,d.value=t,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.error("获取看板信息失败:",e.t0),(0,p.CF)("获取投票看板失败，请检查合约和网络连接。");case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=(0,o.Z)((0,c.Z)().mark((function e(t){var r,u;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,w();case 4:if(r=e.sent,r){e.next=7;break}return e.abrupt("return",(0,p.CF)("请连接MetaMask！"));case 7:return u=null,e.prev=8,u=(0,p.CF)({type:"loading",message:"正在发送投票交易...",forbidClick:!0,duration:0}),e.next=12,n.methods.vote(t).send({from:r});case 12:return u&&u.close(),(0,p.CF)("投票成功！"),e.next=16,b();case 16:e.next=23;break;case 18:e.prev=18,e.t0=e["catch"](8),console.error("投票失败:",e.t0),u&&u.close(),(0,p.CF)("投票失败，请检查是否有投票权或已投票。");case 23:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}();return(0,i.bv)((function(){b()})),function(e,t){var n=a.iz,c=u.zx,o=r.bL;return(0,i.wg)(),(0,i.iD)("div",v,[(0,i.Wm)(n,null,{default:(0,i.w5)((function(){return[(0,i.Uk)("投票看板")]})),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.value,(function(e,t){return(0,i.wg)(),(0,i.j4)(o,{title:e.name,icon:"shop-o",key:t},{"right-icon":(0,i.w5)((function(){return[(0,i.Wm)(c,{size:"small",type:"primary",onClick:function(e){return h(t)}},{default:(0,i.w5)((function(){return[(0,i.Uk)(" 投票 ("+(0,s.zw)(e.voteCount)+" 票) ",1)]})),_:2},1032,["onClick"])]})),_:2},1032,["title"])})),128)),0===d.value.length?((0,i.wg)(),(0,i.iD)("div",k," 加载中或没有主题 ")):(0,i.kq)("",!0)])}}},d=w,b=d},7461:(e,t,n)=>{n(1958),n(368),n(6742),n(3094)}}]);
//# sourceMappingURL=board.84b32e3a.js.map